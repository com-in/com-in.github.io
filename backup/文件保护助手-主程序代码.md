### 部分代码，完整代码请看 [此处](https://github.com/com-in/filesafe)
'''e
.版本 2
.支持库 dp1
.支持库 edroptarget
.支持库 eAPI

.程序集 窗口程序集_启动窗口

.子程序 _按钮1_被单击
.局部变量 文件, 字节集, , , 该文件原文件的机器码
.局部变量 加密后文件, 字节集, , , 该文件加密后的机器码
.局部变量 文件名, 文本型, , , 该文件的文件名+扩展名

.如果真 (编辑框1.内容 ＝ “”)
    信息框 (“未选择文件！”, #错误图标, “数据错误”, )
    返回 ()
.如果真结束
.如果真 (编辑框2.内容 ＝ “”)
    信息框 (“未选择输出路径！”, #错误图标, “数据错误”, )
    返回 ()
.如果真结束
.如果真 (编辑框3.内容 ＝ “”)
    信息框 (“没有密码”, #错误图标, “密码错误”, )
    返回 ()
.如果真结束
.如果真 (编辑框4.内容 ＝ “”)
    信息框 (“没有密码”, #错误图标, “密码错误”, )
    返回 ()
.如果真结束
.如果真 (编辑框3.内容 ≠ 编辑框4.内容)
    信息框 (“密码不一致”, #错误图标, “密码错误”, )
    返回 ()
.如果真结束
信息框 (“加密开始！”, #信息图标, “加密”, )  ' 提示用户加密已开始
文件名 ＝ 取文本右边 (编辑框1.内容, 取文本长度 (编辑框1.内容) － 倒找文本 (编辑框1.内容, “\”, , 假))  ' 获取文件扩展名，以便输出时添加扩展名
文件 ＝ 读入文件 (编辑框1.内容)  ' 将选定的文件添加进容器中
加密后文件 ＝ 加密数据 (文件, 编辑框3.内容, )  ' 将选定文件加密
.判断开始 (写到文件 (编辑框2.内容 ＋ “\_加密的” ＋ 文件名, 加密后文件))  ' 写出文件，并判断写出是否成功
    信息框 (“加密数据成功！”, #信息图标, “成功”, )  ' 写出成功后弹出信息框提示成功
.默认
    信息框 (“加密数据失败！”, #错误图标, “失败”, )  ' 写出失败后弹出信息框提示失败
.判断结束


.子程序 _按钮3_被单击
.局部变量 文件, 字节集, , , 该文件原文件的机器码
.局部变量 解密后文件, 字节集, , , 该文件解密后的机器码
.局部变量 文件名, 文本型, , , 该文件的文件名+扩展名

.如果真 (编辑框5.内容 ＝ “”)
    信息框 (“未选择文件！”, #错误图标, “数据错误”, )
    返回 ()
.如果真结束
.如果真 (编辑框6.内容 ＝ “”)
    信息框 (“未选择输出路径！”, #错误图标, “数据错误”, )
    返回 ()
.如果真结束
.如果真 (编辑框7.内容 ＝ “”)
    信息框 (“没有密码”, #错误图标, “密码错误”, )
    返回 ()
.如果真结束
信息框 (“解密开始！”, 0, , )  ' 提示用户解密已开始
文件名 ＝ 取文本右边 (编辑框5.内容, 取文本长度 (编辑框5.内容) － 倒找文本 (编辑框5.内容, “\”, , 假))  ' 获取文件扩展名，以便输出时添加扩展名
文件 ＝ 读入文件 (编辑框5.内容)  ' 将选定的文件添加进容器中
解密后文件 ＝ 解密数据 (文件, 编辑框7.内容, )  ' 将选定文件解密
.判断开始 (写到文件 (编辑框6.内容 ＋ “\_解密的” ＋ 文件名, 解密后文件))  ' 写出文件，并判断写出是否成功
    信息框 (“解密数据成功！”, 0, , )  ' 写出成功后弹出信息框提示成功
.默认
    信息框 (“解密数据失败！”, 0, , )  ' 写出失败后弹出信息框提示失败
.判断结束


.子程序 _按钮2_被单击

编辑框1.内容 ＝ “”
编辑框2.内容 ＝ “”
编辑框3.内容 ＝ “”
编辑框4.内容 ＝ “”

.子程序 _按钮4_被单击

编辑框5.内容 ＝ “”
编辑框6.内容 ＝ “”
编辑框7.内容 ＝ “”

.子程序 _关于程序_被选择

载入 (窗口1, , 真)

.子程序 _程序版本_被选择

信息框 (“版本：15”, #信息图标, “版本”, )

.子程序 _说明文档_被选择

载入 (窗口3, , 真)

.子程序 _加密文件_被选择

载入 (窗口4, , 真)

.子程序 _解密文件_被选择

载入 (窗口5, , 真)

.子程序 _更新记录_被选择

载入 (窗口2, , 真)

.子程序 _按钮5_被单击
.局部变量 文件路径, 文本型
.局部变量 返回值2, 逻辑型

通用对话框1.过滤器 ＝ “ 所有文件|*.*”
通用对话框1.打开 ()
编辑框1.内容 ＝ 通用对话框1.文件名

.子程序 _按钮8_被单击
.局部变量 文件路径, 文本型
.局部变量 返回值2, 逻辑型

通用对话框1.过滤器 ＝ “所有文件|*.*”
通用对话框1.打开 ()
编辑框5.内容 ＝ 通用对话框1.文件名

.子程序 _按钮6_被单击

编辑框3.输入方式 ＝ 0
编辑框4.输入方式 ＝ 0
按钮6.可视 ＝ 假
按钮7.可视 ＝ 真

.子程序 _按钮7_被单击

编辑框3.输入方式 ＝ 2
编辑框4.输入方式 ＝ 2
按钮7.可视 ＝ 假
按钮6.可视 ＝ 真

.子程序 __启动窗口_创建完毕
.局部变量 文件路径, 文本型

编辑框3.输入方式 ＝ 2
编辑框4.输入方式 ＝ 2
按钮9.可视 ＝ 假
按钮10.可视 ＝ 真
按钮7.可视 ＝ 假
按钮6.可视 ＝ 真
拖放对象1.注册拖放控件 (编辑框1.取窗口句柄 ())
拖放对象2.注册拖放控件 (编辑框5.取窗口句柄 ())

.子程序 _按钮9_被单击

按钮9.可视 ＝ 假
按钮10.可视 ＝ 真
编辑框7.输入方式 ＝ 2

.子程序 _按钮10_被单击

编辑框7.输入方式 ＝ 0
按钮9.可视 ＝ 真
按钮10.可视 ＝ 假

.子程序 _注册程序_被选择

载入 (窗口7, , 真)

.子程序 _高级功能_被选择

.如果真 (激活状态 ＝ 0)
    信息框 (“你还没有激活软件！”, #信息图标, “出错了！”, )
    载入 (窗口7, , 真)
    返回 ()
.如果真结束
.如果真 (激活状态 ＝ 1)
    载入 (窗口10, , 假)
.如果真结束


.子程序 _按钮12_被单击
.局部变量 系统信息, 系统信息

取系统信息 (系统信息)
编辑框2.内容 ＝ “C:\Users\” ＋ 系统信息.当前用户 ＋ “\Desktop\”

.子程序 _按钮11_被单击
.局部变量 系统信息, 系统信息

取系统信息 (系统信息)
编辑框6.内容 ＝ “C:\Users\” ＋ 系统信息.当前用户 ＋ “\Desktop\”

.子程序 _开源_被选择

载入 (窗口14, , 真)

.子程序 _退出_被选择

.如果真 (信息框 (“你确定要退出吗？”, #是否钮, “确定”, ) ＝ #是钮)
    _启动窗口.销毁 ()
.如果真结束


.子程序 _设置_被选择

载入 (窗口6, , 假)

.子程序 _拖放对象1_得到文件
.参数 接收到的文本, 文本型

编辑框1.内容 ＝ 到文本 (接收到的文本)

.子程序 _拖放对象2_得到文件
.参数 接收到的文本, 文本型

编辑框5.内容 ＝ 到文本 (接收到的文本)

.子程序 _压缩文件_被选择

运行 (“./Data/bandizip.exe”, 假, )
信息框 (“运行时会有少许延迟，请耐心等待”, 0, , )
'''

Thanks Please give me a star
